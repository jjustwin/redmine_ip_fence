# redmine 附件网络隔离开发指南

## 概述
本文档旨在为开发人员提供在redmine中实现附件网络隔离功能的详细开发指导

## 需求
* 这是一款redmine的插件，需要在redmine中安装和启用
* 插件支持redmine 5.0及以上版本
* 在附件表中增加字段：ip，是否敏感（0,1）
* 在插件设置中提供配置界面，配置中增加网络ip段的配置，如：192.168.*.*,10.10.2.*，该配置在settings表中存储
* 上传文件不受限制，上面的配置为内网敏感文件的上传ip段，上传文件时，如果当前ip在配置的ip段中，当前附件的是否敏感为1
* 附件下载时，如果当前访问者ip不在配置的ip段内，则只能下载不敏感的附件，否则可以下载所有附件
* 当不能下载时，给出用户提示：该文件为内网上传，请联系上传人员获取
* 目前已经确定的，访问者ip可以这样获取user_ip = request.headers['X-Forwarded-For'] || request.remote_ip